{% extends "placement/base.html" %}

{% block app_content %}
{% for year,name in years_list %}
<div style="width:100px;float:left;">
  <a href="{% url 'placement.views_results.department' year=year department_id=dept_code degree=degree %}">{{ name }}</a>
</div>
{% endfor %}

{% if years_list %}
<div style="width:150px;float:left;">
  <a href="{% url 'placement.views_results.department' department_id=dept_code degree=degree %}">Current Session</a>
</div>
<div style="clear:both;"></div>
{% endif %}

<h3>{{ dept_name }} - {{ degree|capfirst }} Results({{ session }})</h3>
<hr/>

<div class="tabbable">
  <ul class="nav nav-tabs">

    {% if degree == 'Overall' %}
    <li class="active">
      <a>
        Overall
      </a>
    </li>
    {% else %}
    <li>
      <a href="{% url 'placement.views_results.department' year=year department_id=dept_code %}">
        Overall
      </a>
    </li>
    {% endif %}

    {% for id, name in degrees_list %}
    {% if id == degree %}
    <li class="active">
      <a>
        {{ id }}
      </a>
    </li>
    {% else %}
    <li>
      <a href="{% url 'placement.views_results.department' year=year department_id=dept_code degree=id%}">
        {{ id }}
      </a>
    </li>
    {% endif %}
    {% endfor %}

  </ul>
</div>

<div style="clear:both;"></div>

<table class="sortable table table-striped table-bordered table-condensed" id="t1">
  <thead>
    <tr>
      <th>Total Students</th>
      <th>Registered Students</th>
      <th>Placed Students</th>
      <th>Percent Placed</th>
      <th>Average CTC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{{ total_students }}</td>
      <td>{{ registered_students }}</td>
      <td>{{ placed_students }}</td>
      <td>{{ percent_placed }}%</td>
      <td>{% if avg_ctc %} {{ avg_ctc }} INR {% else %} n/a {% endif %}</td>
    </tr>
  </tbody>
</table>
<div id="pie_charts">
  {% for render_to, title, data in pie_charts %}
  <div id="{{ render_to }}"></div>
  {% endfor %}
</div>
{% endblock %}

{% block scripts %}
<script type="text/javascript" src="{{ STATIC_URL }}js/highcharts.js"></script>
<script type="text/javascript">
  {% for render_to, title, data in pie_charts %}
  $(document).ready(function() {
    chart = new Highcharts.Chart({
      chart: {
        renderTo: '{{ render_to }}',
        plotBackgroundColor: null,
        plotBorderWidth: null,
        plotShadow: false
      },
      title: {
        text: '{{ title }}'
      },
      tooltip: {
        formatter: function() {
          return '<b>'+ this.point.name +'</b>: '+ this.percentage.toFixed(2) +' %';
        }
      },
      plotOptions: {
        pie: {
          allowPointSelect: true,
          cursor: 'pointer',
          dataLabels: {
            enabled: true,
            color: '#000000',
            connectorColor: '#000000',
            formatter: function() {
              return '<b>'+ this.point.name +'</b>: '+ this.point.y;
            }
          }
        }
      },
      series: [{
        type: 'pie',
        name: '{{ title }}',
        data: {{ data|safe }}
      }]
    });
  });
  {% endfor %}
</script>
{% endblock %}
